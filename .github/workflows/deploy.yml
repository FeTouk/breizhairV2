Nom du workflow qui appara√Ætra dans l'onglet "Actions" de votre d√©p√¥t GitHub

name: D√©ploiement FTP
√âv√©nement d√©clencheur : se lance √† chaque "push" sur la branche "main"

on:
push:
branches:
- main

jobs:
ftp-deploy:
# Nom du job
name: D√©ploiement des fichiers sur le serveur FTP
# Le type de machine sur laquelle le job va s'ex√©cuter
runs-on: ubuntu-latest

steps:
# √âtape 1 : R√©cup√©rer le code de votre d√©p√¥t
- name: Checkout du code
  uses: actions/checkout@v3

# √âtape 2 : Mettre en place l'environnement PHP
- name: Configuration de PHP
  uses: shivammathur/setup-php@v2
  with:
    php-version: '8.2' # Assurez-vous que cette version correspond √† celle de votre projet

# √âtape 3 : Installer les d√©pendances Composer (sans les d√©pendances de d√©veloppement)
- name: Installation des d√©pendances Composer
  # üëá CORRECTION ICI : --no-dev devient --no-dev üëá
  run: composer install --optimize-autoloader --no-dev

# √âtape 4 : Mettre en place l'environnement Node.js pour compiler les assets
- name: Configuration de Node.js
  uses: actions/setup-node@v3
  with:
    node-version: '18' # Ou la version que vous utilisez

# √âtape 5 : Installer les d√©pendances NPM et compiler les fichiers CSS/JS
- name: Installation des d√©pendances NPM et compilation
  run: |
    npm install
    npm run build

# √âtape 6 : D√©ployer les fichiers sur le serveur FTP
- name: D√©ploiement FTP
  uses: SamKirkland/FTP-Deploy-Action@4.3.3
  with:
    # Adresse de votre serveur FTP (√† stocker dans les secrets)
    server: ${{ secrets.FTP_SERVER }}
    # Nom d'utilisateur FTP (√† stocker dans les secrets)
    username: ${{ secrets.FTP_USERNAME }}
    # Mot de passe FTP (√† stocker dans les secrets)
    password: ${{ secrets.FTP_PASSWORD }}
    # Le dossier de destination sur votre serveur FTP
    # Exemple : '/public_html/breizhair/' ou '/www/breizhair/'
    server-dir: /public_html/
    # Exclure les fichiers et dossiers inutiles du d√©ploiement
    exclude: |
      **/.git*
      **/.git*/**
      **/node_modules/**

